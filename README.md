# 網路監控器

這是一個用於監控網路連線狀態的 Python 程式，當檢測到遠端軟體運行時，會自動監控網路連線，並在網路斷線時嘗試自動重新開機修復問題。新版 **支援系統匣隱藏** 與 **自動監控**，讓程式更低干擾。

## 功能特色

- **智能檢測**：偵測遠端軟體自動啟動監控  
- **自動重啟**：網路斷線時自動重開機修復  
- **系統匣隱藏**：視窗關閉即縮小到工具列右下角，不干擾作業  
- **詳細日誌**：完整記錄網路狀態和故障分析  
- **限制保護**：防止無限重啟，設有次數與時間限制  
- **廣泛支援**：TeamViewer、AnyDesk、Parsec、RustDesk、NoMachine 等主流軟體  
- **GUI介面**：直觀操作 + 自動監控  
- **測試工具**：內建檢測工具確保功能正常  

## 檔案說明

- `network_monitor_gui.py` - **🌟 GUI圖形介面版本（支援系統匣隱藏，自動監控）**
- `network_monitor_simple.py` - 輕量命令列版
- `network_monitor.py` - 完整命令列版（需安裝套件）
- `test_detection.py` - **🧪 檢測測試工具**
- `config.json` - 配置檔案
- `start_gui.bat` - GUI版本啟動器（自動獲取管理員權限）
- `start_monitor.bat` - 命令列版啟動器
- `requirements.txt` - 依賴套件
- `GUI_使用說明.md` - GUI詳細操作指南  

## 快速開始

### 1️⃣ 安裝套件（GUI版需要 pystray 與 Pillow）

```powershell
pip install pystray pillow
```

### 2️⃣ 檢測測試（建議先執行）

```powershell
python test_detection.py
```

確認：
- 當前運行的遠端軟體
- 網路連線狀態
- 系統相容性  

### 3️⃣ 執行 GUI 版本

```powershell
python network_monitor_gui.py
```
或使用 `start_gui.bat`（自動管理員權限）

**GUI版特色：**
- 🖥️ 自動啟動監控
- 📝 內建日誌查看器
- 🔘 一鍵操作控制
- 🪟 **關閉視窗 → 自動縮小到系統匣**  
- 🟢 綠色：正常、🔴 紅色：異常、🟡 黃色：警告

### 4️⃣ 其他版本

- 簡化命令列版（僅標準庫）：
  ```powershell
  python network_monitor_simple.py
  ```
- 完整命令列版：
  ```powershell
  pip install -r requirements.txt
  python network_monitor.py
  ```

## GUI版本操作區域

- **狀態顯示區域**：網路狀態、遠端軟體、監控狀態、最後檢查時間、重啟統計
- **控制按鈕**：開始監控 / 停止監控 / 重置計數器 / 測試連線
- **設定區域**：檢查間隔、最大重啟次數、應用設定
- **日誌顯示**：即時日誌、清除日誌、自動滾動

## 系統匣隱藏與操作

- 按 X 關閉視窗時，程式會隱藏到右下角系統匣，不會結束  
- 右鍵圖示可顯示選單：
  - **顯示視窗**
  - **開始/停止監控**
  - **結束程式**

## 安全與限制

- **自動重啟**：無需再確認對話框  
- **冷卻時間**：預設 1 小時，防止頻繁重啟  
- **最大重啟次數**：預設 2 次，可自行修改  

## 常見問題

- **需要管理員權限**：Windows 上執行重啟動作需要管理員權限  
- **防毒軟體**：請將程式加入白名單避免阻擋  
- **初次建議**：先用 `test_detection.py` 測試環境  
- **重置重啟計數**：刪除 `gui_reboot_count.json`  

## 版本歷史 📅

### v1.0.1 (2025-09-19) - 最新版本
- ✅ **新增系統匣隱藏**：關閉視窗自動最小化到托盤  
- ✅ **啟動即自動監控**  
- ✅ **去除重啟前確認對話框**：完全自動化  
- ✅ **靜音子程序**：不再彈出命令提示視窗  
- ✅ **更新說明文件**：更符合現況  

### v1.0.01 (2025-09-10)
- 新增 Parsec / RustDesk / NoMachine 支援
- 優化網路檢測邏輯
- 新增檢測工具
- 改善GUI初始化

### v1.0 (2025-08-29)
- 初始版本：基本監控 + 自動重啟 + GUI  

---

## 📄 授權

本專案採用 MIT 授權條款 [MIT License](https://github.com/kuroneko11375/NetworkMonitor/blob/main/LICENSE)
